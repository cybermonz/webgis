<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>Tasmania Web GIS</title>

<!-- OpenLayers -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/ol@v10.6.1/ol.css" />
<script src="https://cdn.jsdelivr.net/npm/ol@v10.6.1/dist/ol.js"></script>

<!-- Layer Switcher -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/ol-layerswitcher@4.1.2/dist/ol-layerswitcher.css" />
<script src="https://cdn.jsdelivr.net/npm/ol-layerswitcher@4.1.2/dist/ol-layerswitcher.js"></script>

<style>
  html, body {
    height: 100%;
    margin: 0;
    font-family: "Segoe UI", Roboto, Arial, sans-serif;
    background-color: #0d1117;
    color: #e6edf3;
  }

  #header {
    padding: 12px 20px;
    background: linear-gradient(90deg, #0d1117 0%, #161b22 100%);
    border-bottom: 1px solid #30363d;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  #header h3, #header h4 {
    margin: 0;
  }

  #header h3 {
    font-size: 18px;
    font-weight: 600;
    color: #58a6ff;
  }

  #header h4 {
    font-size: 13px;
    font-weight: 400;
    color: #8b949e;
  }

  #map {
    width: 100%;
    height: calc(100vh - 60px);
    border-top: 1px solid #21262d;
  }

  /* Make OpenLayers controls look modern */
  .ol-control {
    background-color: #161b22 !important;
    border-radius: 6px !important;
    border: 1px solid #30363d !important;
    color: #e6edf3 !important;
  }

  .ol-zoom {
    top: 0.8em;
    left: 0.8em;
  }

  .ol-layerswitcher {
    top: 0.8em;
    right: 0.8em;
    background-color: #161b22 !important;
    border: 1px solid #30363d !important;
    border-radius: 8px !important;
  }

  .layer-switcher {
    color: #e6edf3;
  }

  .ol-layerswitcher button {
    background-color: #161b22 !important;
    color: #e6edf3 !important;
  }
</style>
</head>
<body>

<div id="header">
  <div>
    <h3>Lab 3: Question 4 â€” Tasmania Web GIS</h3>
    <h4>Author: Monica Layug</h4>
  </div>
</div>

<div id="map"></div>

<script>
const AZURE_KEY = "5XkeavvoPv61d5JlCImnXL0CSVyYmwFx6vkdpDUAVHc6JiNC2pPOJQQJ99BJACYeBjFhIhSbAAAgAZMP4Rzq";
const wmsUrl = "https://data.stategrowth.tas.gov.au/geoserver/ows";

// Tasmania center
const tasCenter = ol.proj.fromLonLat([146.8, -42.0]);

// Base layer: Azure Road
const azureRoad = new ol.layer.Tile({
  title: "Azure Maps Road",
  type: "base",
  visible: true,
  source: new ol.source.XYZ({
    url: `https://atlas.microsoft.com/map/tile?api-version=2022-08-01&tilesetId=microsoft.base.road&zoom={z}&x={x}&y={y}&subscription-key=${AZURE_KEY}`,
    crossOrigin: "anonymous",
    maxZoom: 19
  })
});

// WMS layers
const carriageways = new ol.layer.Tile({
  title: "Carriageways (WMS)",
  source: new ol.source.TileWMS({
    url: wmsUrl,
    params: {
      LAYERS: "ssg:GEO_CARRIAGEWAY",
      FORMAT: "image/png",
      TRANSPARENT: true,
      VERSION: "1.3.0",
      CRS: "CRS:84"
    },
    serverType: "geoserver",
    crossOrigin: "anonymous"
  }),
  visible: true
});

const cadastre = new ol.layer.Tile({
  title: "Cadastre Parcels (WMS)",
  source: new ol.source.TileWMS({
    url: wmsUrl,
    params: {
      LAYERS: "pam:GEO_CADASTRE",
      FORMAT: "image/png",
      TRANSPARENT: true,
      VERSION: "1.3.0",
      CRS: "CRS:84"
    },
    serverType: "geoserver",
    crossOrigin: "anonymous"
  }),
  visible: false
});

const busTrips = new ol.layer.Tile({
  title: "Bus Trips (WMS)",
  source: new ol.source.TileWMS({
    url: wmsUrl,
    params: {
      LAYERS: "ssg:GEO_BRM_TRIP",
      FORMAT: "image/png",
      TRANSPARENT: true,
      VERSION: "1.3.0",
      CRS: "CRS:84"
    },
    serverType: "geoserver",
    crossOrigin: "anonymous"
  }),
  visible: false
});

// Map
const map = new ol.Map({
  target: "map",
  layers: [
    new ol.layer.Group({ title: "Base Maps", layers: [azureRoad] }),
    new ol.layer.Group({ title: "Tasmania Overlays", layers: [carriageways, cadastre, busTrips] })
  ],
  view: new ol.View({
    center: tasCenter,
    zoom: 7
  }),
  controls: [
    new ol.control.Zoom(),
    new LayerSwitcher({ tipLabel: "Layers", groupSelectStyle: "children" })
  ]
});
</script>

</body>
</html>
